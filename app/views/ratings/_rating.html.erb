<% unless @restaurant.ratings.empty? %>
  <% @restaurant.ratings.each do |rate| %>
    <div class="media" style="padding: 10px; margin: 0px;">
      <div class="media-left" style="padding: 0 25px 10px 10px;">
        <%= image_tag(display_user(rate.user), width: 64, height: 64, class: 'img-circle') %>
      </div>
      <div class="media-body" style="max-width: 575px;">
        <h4 class="media-heading">
          <%= link_to rate.user.name, rate.user %>
          <small>
            <% rate.rate.times do %>
              <%= icon('star')%>
            <% end %>
            <% (5-rate.rate).times do %>
              <%= icon('star-o')%>
            <% end %>
            <% if current_user === rate.user %>
              <%= link_to "#{icon('pencil', nil, style: 'margin-left: 20px;')}".html_safe, edit_rating_path(rate), remote: true, data: { toggle: 'modal', target: '#myModal'} %>
            <% end %>
          </small>
        </h4>
        <p><small><%= distance_of_time_in_words_to_now(rate.created_at) %> ago</small></p>
        <p><%= rate.comment %></p>
        <p>
          <% if rate.user_liked?(current_user) %>
            <%= link_to "#{icon('heart-o', pluralize(rate.likes.count, 'Unlike'))}".html_safe, delete_like_path(user: current_user.id, rating: rate.id), class: 'btn btn-like-comment', method: :delete, remote: true %> 
          <% else %>
            <%= link_to "#{icon('heart-o', pluralize(rate.likes.count, 'Like'))}".html_safe, likes_path(rate_id: rate.id), class: 'btn btn-like-comment', method: :post, remote: true %> 
          <% end %>
          <%= link_to "#{icon('comments-o', pluralize(rate.replies.count, 'Reply'))}".html_safe, new_reply_path(rate: rate.id), class: 'btn btn-like-comment', remote: true %>
        </p>
      </div>
    </div>
    <% if rate.replies.present? %>
      <% rate.replies.last(3).each do |reply| %>
        <div class="media" style="padding: 10px 50px 10px 50px; margin: 0px;">
          <div class="media-left">
            <div style="background: url('<%= asset_path(display_user(reply.user)) %>'); background-size: cover; background-position: center center; width: 40px; height: 40px;" class="img-circle"></div>
          </div>
          <div class="media-body" style="max-width: 565px;">
            <h5 class="media-heading">
              <%= reply.user.name %> <small> - <%= distance_of_time_in_words_to_now(reply.created_at) %> ago</small>
            </h5>
            <p><%= reply.comment %></p>
          </div>
        </div>
      <% end %>
    <% end %>
    <div id="rating_reply_<%= rate.id %>" style="padding: 5px 20px;">
          
    </div>
  <% end %>
<% else %>
  <div style="height: 75px;">
    <h4>No Reviews yet.</h4>
  </div>
<% end %>